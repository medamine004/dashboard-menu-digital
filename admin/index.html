<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard • Tarek</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>
    <link rel="stylesheet" href="admin.css">
    <script src="../core/data.js"></script>
</head>
<body>
    <nav class="sidebar">
        <div class="logo">Tarek Admin</div>
        <div class="nav-link active" onclick="switchTab('dashboard')">
            <i class="fas fa-chart-line"></i> <span>Statistiques</span>
        </div>
        <div class="nav-link" onclick="switchTab('orders')">
            <i class="fas fa-clipboard-list"></i> <span>Commandes</span>
        </div>
        <div class="nav-link" onclick="switchTab('products')">
            <i class="fas fa-utensils"></i> <span>Produits</span>
        </div>
        <div class="nav-link" onclick="logout()" style="margin-top:auto; color:#ef4444">
            <i class="fas fa-sign-out-alt"></i> <span>Déconnexion</span>
        </div>
    </nav>

    <main class="main-content">
        
        <div id="dashboard" class="section active">
            <h2>Vue d'ensemble</h2>
            <div class="stats-grid" style="margin-top:1rem">
                <div class="stat-card">
                    <div class="stat-val" id="stat-revenue-today">0 DT</div>
                    <div class="stat-label">CA Aujourd'hui</div>
                </div>
                <div class="stat-card">
                    <div class="stat-val" id="stat-orders-count">0</div>
                    <div class="stat-label">Commandes du jour</div>
                </div>
                <div class="stat-card">
                    <div class="stat-val" id="stat-revenue-7days">0 DT</div>
                    <div class="stat-label">CA 7 Jours</div>
                </div>
            </div>
            
            <h3>Dernières commandes</h3>
            <div class="table-container">
                <table id="dash-orders-table"></table>
            </div>
        </div>

        <div id="orders" class="section">
            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:1rem">
                <h2>Toutes les Commandes</h2>
                <button class="btn btn-primary" onclick="loadOrders()"><i class="fas fa-sync"></i> Actualiser</button>
            </div>
            <div class="table-container">
                <table id="all-orders-table">
                    <thead>
                        <tr>
                            <th>Heure</th>
                            <th>Client/Table</th>
                            <th>Total</th>
                            <th>Type</th>
                            <th>Statut</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>

        <div id="products" class="section">
            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:1rem">
                <h2>Gestion du Menu</h2>
                <button class="btn btn-primary" onclick="openProductModal()"><i class="fas fa-plus"></i> Nouveau Produit</button>
            </div>
            <div class="table-container">
                <table id="products-table">
                    <thead>
                        <tr>
                            <th>Image</th>
                            <th>Nom</th>
                            <th>Catégorie</th>
                            <th>Prix</th>
                            <th>Visible</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>

    </main>

    <div class="modal" id="productModal">
        <div class="modal-content">
            <h3 id="modalTitle" style="margin-bottom:1rem">Ajouter Produit</h3>
            <input type="hidden" id="prodId">
            
            <div class="form-group">
                <label>Nom du produit</label>
                <input type="text" id="prodName">
            </div>
            <div class="form-group">
                <label>Catégorie</label>
                <input type="text" id="prodCat" list="catList">
                <datalist id="catList"></datalist>
            </div>
            <div class="form-group">
                <label>Prix (DT)</label>
                <input type="number" step="0.5" id="prodPrice">
            </div>
            
            <div class="form-group">
                <label>Description (optionnel)</label>
                <input type="text" id="prodDesc">
            </div>

            <div class="form-group">
                <label>Image</label>
                <input type="file" id="prodImgFile" accept="image/*" style="margin-bottom: 10px; width:100%">
                
                <input type="hidden" id="prodImg">
                
                <div style="text-align: center; margin-top: 5px;">
                    <img id="imgPreview" src="" style="max-height: 80px; display: none; border-radius: 6px; border: 1px solid #ddd;">
                </div>
            </div>
            <div style="display:flex; gap:10px; justify-content:flex-end; margin-top:1rem;">
    <button type="button" class="btn" onclick="closeModal()">Annuler</button>
    <button type="button" class="btn btn-primary" onclick="saveProduct()">Enregistrer</button>
</div>
        </div>
    </div>

    <script src="admin.js"></script>
</body>
</html>
